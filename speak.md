

## 自己紹介

フリーのバックエンドエンジニア。DB周り、table設計とか。 \
統計、分析システムのDB検索を1hから6mに短縮する男。 \
php, python, goとかのバックエンド側のframeworkも普通にわかります。 \
[twitter: @k_otogawa](https://twitter.com/k_otogawa)

## 人はなぜtypescriptにするか

別に変えなくてもいいじゃん?

## javascriptの難点

1. phpと同じく文字列か数字か曖昧

これはどう言うことかと言うと

"3"と3
と文字列の3と数字としての3が
明確に分かれているけど、

そんな困らんやん
と思うかもですが、これはtypescriptの時の
createStyleなどcssの指定に問題になります。

3と"3"どっちでも良かったのが、
3でないとエラーになります。

のちのcreateStyleや

cssで

また!importantがサポートされていないプロパティは、
どうしようもなく、サポートするきもない場合もある。

!important自体がcssとしてなんでもできるからあまりよくない
と思っている人も多い。

importtant

2. ブラケット記法とかjs独自の記法や考え方多い。

他の言語でもあるけど、
スプレッド構文や{}を多用するので、
見つかったり、

3. Java並みにネットの情報が古かったり書き方に問題あるコードがある。

これはあるあるだと思うんですが、
プログラミングスクールのわけわからないメガネをかけた男と女の先輩後輩が出てきて、
「今日は何々教えるよ」
「お願いします先輩」
みたいなやつがあって、そのコードが知らなくていい書き方だったり、
C++だったらヤバイコードだったり
\nで改行と書かれているけど、メジャーな言語はOSの改行コードの文字を挿入する関数があるから
それ書いた方がいいとか色々ツッコミどころあったね。

## 結果として発生する問題

1. vscodeのインテリセンスがすべてany...

2. 職人じゃ無いと読めないコードが描きがち

3. なんかよくわからない、けど動く。

4. コメント書かないやつ、全体見れないやつが出てくると*崩壊*する。

reactだったら、関数の引数にpropsという変数を作って、キーを省略して...というのが多い。
これ何が嫌かと言うとキー省略するとインテリセンス効かないんですよ。
OSSでみんなが使うライブラリを
これ一つのコンポーネントを追っていってこういう感じになってるから
暗黙知がめちゃくちゃ多い。

ちゃんとドキュメント書いてるならいいけどこの運用方法って全体を理解していること
前提なんですよ。

だから全体見れない人が増えてきて、jsわからんよねとなってダメになったりします。

割とnodejsは一人親方の所が採用しているパターンが多いから、
ここら辺の難解さや暗黙知に対して感覚マヒしている人が多かったりします。
typescript採用して、ts周りのライブラリの管理考えたらts採用しなくても
いいのでは？とりあえず動かすには邪魔と思う人もいる。

最近はtypescript疲れという言葉ができたみたいに、
tsconfig.jsonの設定や管理が難しくて、現場によって違うし、
デフォルトで作成してもできる設定ファイル違うから、
あれ？ネットだったらビルド通るのに、このプロジェクトだったら通らないとか。
真偽さだかではないですけどtwitterで
準委任契約で入って、ビルド通すために全てany型に書き換えて
いくという謎のテロがあったり...

この状態でコメント書かないまま規模が大きくなって、人の出入りが激しくなると...

## typescript化による恩恵

書いてある通り

1. vscodeなどエディタで型情報が見えるようになる。
2. エディタでインテリセンスが効くようになる。
3. jsに強い人でなくても、割と読めるようになる。

こういう恩恵があるから選択するわけですが、どの手段を取るかですね。

## どの手段を取るか？

手段複数あるのか?と思うじゃ無いですか？

1. 直接typescriptにする。(jsdoc形式などちゃんとしたコメントが無かったり、書いた本人に効かないと難しい。)
2. allowJSを使う(本番のnodejsを少しずつtypescriptに切り替える方法。)
3. // @ts-checkを使う(デメリット無し)

## 直接typescriptにする方法1

1. typescript用のライブラリの追加

```bash
npm install --devDependency typescript @types/node-sass @types/node @types/jest @matetial-ui/types/ @types/react @types/react-dom
```

2. tsconfig.json を取得するためにcreate-react-appでプロジェクト作成

これはなぜかというと、tsconfig.jsonという設定ファイルをガリガリ書くのが難しいから、
新しくプロジェクトを作ったものを使おうという事です。

3. jsconfig.jsonの内容をtsconfig.jsonに移す

jsconfig.jsonはtsconfig.jsonのjs版でnodejsの設定を色々書けるやつです。
jsconfig.jsonとtsconfig.jsonは両立できないので、設定を移して、jsconfig.jsonは消します。

## 直接typescriptにする方法2

4. 各jsファイルのimportが.jsになっていたら修正。

import from 'components/hello.js'
みたいなやつのjsを消す。
jsからtsに帰るから当然

5. ファイルの拡張子をjsからtsに変更する

手打ちで拡張子を変えるのは時間かかるのと危険なので、
powershellで一括で拡張子を帰る事をおすすめします。

ここで一度ビルドしてみてください。ファイルの拡張子が間違っているやつがあったら、
拡張子のエラーがでるけど、ファイルの拡張子に問題なかったら、型エラーが出ます。

6. linter系のライブラリのtypescript化

linter、っていうのは何かというとこう書いた方が、綺麗だよとか
コード規約に則ってエラーを出すツールです。


## 直接typescriptにする方法3

あとは*根気*です。
釈の都合上でここまでの説明とします。
このやり方の続きはgithubにあるので参照してください。

## 直接typescriptにする方法4


## allowJSを使う方法1

つい１週間前に知った方法。
msのちよまどさんのtweetでたまたま知った。

## allowJSを使う方法2


(どういうことかというと、)

結局の所jsの文法チェックの杜撰さが嫌いなので
interface 


## ts-checkを使う方法4


reactの場合は下のような感じ。


